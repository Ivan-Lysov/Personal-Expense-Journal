# Personal-Expense-Journal üíºüí∏

## 1. –ó–∞—á–µ–º –Ω—É–∂–µ–Ω –±–æ—Ç

–ë—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—Ö–æ–¥—ã –ø—Ä—è–º–æ –≤ Telegram –∏ –ø–æ–ª—É—á–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –æ—Ç—á—ë—Ç—ã:

* ‚úÖ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∫—É–ø–∫—É –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤;
* üìí –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏;
* üì§ –≤—ã–≥—Ä—É–∑–∏—Ç—å CSV;
* ‚ûï —É–∑–Ω–∞—Ç—å —Å—É–º–º—É –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 –ø–æ–∫—É–ø–æ–∫.

> üí° –ò–¥–µ–∏ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è ‚Äî —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –≤ **Issues**.

---

## 2. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ—Ç (–≥–ª–∞–∑–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

### 2.1. –°—Ç–∞—Ä—Ç ‚ñ∂Ô∏è

–ö–æ–º–∞–Ω–¥–∞ **/start**:

* –ï—Å–ª–∏ –±–∞–∑—ã –µ—â—ë –Ω–µ—Ç ‚Äî –±–æ—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç **–°–æ–∑–¥–∞—Ç—å –ë–î** (–∫–Ω–æ–ø–∫–∞). –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –º–µ–Ω—é.
* –ï—Å–ª–∏ –±–∞–∑–∞ —É–∂–µ –µ—Å—Ç—å ‚Äî —Å—Ä–∞–∑—É –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –º–µ–Ω—é.

### 2.2. –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é (–∫–Ω–æ–ø–∫–∏) üß≠

* **–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä**
* **–ü–æ—Å–ª–µ–¥–Ω–∏–µ (5‚Äì10)**
* **–ü–æ–ª—É—á–∏—Ç—å –ë–î (CSV)**
* **–°—É–º–º–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10**
* **–°–ø—Ä–∞–≤–∫–∞**

### 2.3. –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä ‚Äî –ø–æ—à–∞–≥–æ–≤—ã–π –¥–∏–∞–ª–æ–≥ üßæ

1. **–ö–∞—Ç–µ–≥–æ—Ä–∏—è**
   –ë–æ—Ç –ø–æ–∫–∞–∂–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (*–ï–¥–∞, –¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç, –ê–ø—Ç–µ–∫–∞, –î–æ–º, –û–¥–µ–∂–¥–∞, –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è, –ü—Ä–æ—á–µ–µ*) –∏ –∫–Ω–æ–ø–∫—É **‚ûï –î—Ä—É–≥–∞—è‚Ä¶**.
   –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –≥–æ—Ç–æ–≤—É—é –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ—é (–≤–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–æ–º).

2. **–ú–∞–≥–∞–∑–∏–Ω**
   –°–ø–∏—Å–æ–∫ –ø—Ä–∏–º–µ—Ä–æ–≤ (*–ü—è—Ç—ë—Ä–æ—á–∫–∞, –ú–∞–≥–Ω–∏—Ç, –ê–ø—Ç–µ–∫–∞ 36,6, Ozon, Wildberries, –õ–µ–Ω—Ç–∞, –ü—Ä–æ—á–µ–µ*) –∏ **‚ûï –î—Ä—É–≥–æ–π‚Ä¶**.
   –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —Å–≤–æ–π.

3. **–°—É–º–º–∞**
   –í–≤–µ—Å—Ç–∏ —á–∏—Å–ª–æ (`379.90` –∏–ª–∏ `379,90`). –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Å—É–º–º–∞ **> 0**.

4. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**
   –ö–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç –∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫.

5. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ**
   –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∏—Å–∏ (–¥–∞—Ç–∞, –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –º–∞–≥–∞–∑–∏–Ω, —Å—É–º–º–∞, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π). –ö–Ω–æ–ø–∫–∏: **–°–æ—Ö—Ä–∞–Ω–∏—Ç—å** / **–û—Ç–º–µ–Ω–∞**.
   –ù–∞ ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å¬ª –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç ¬´–ì–æ—Ç–æ–≤–æ ‚úÖ¬ª –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤ –º–µ–Ω—é.

### 2.4. –ü–æ—Å–ª–µ–¥–Ω–∏–µ (5‚Äì10) üïò

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç 5‚Äì10 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–ø–∏—Å–µ–π: `–¥–∞—Ç–∞ ¬∑ —Å—É–º–º–∞ ¬∑ –∫–∞—Ç–µ–≥–æ—Ä–∏—è ¬∑ –º–∞–≥–∞–∑–∏–Ω ¬∑ (–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π)`.
–ö–Ω–æ–ø–∫–∞ **–ü–æ–∫–∞–∑–∞—Ç—å –µ—â—ë** ‚Äî –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã.

### 2.5. –ü–æ–ª—É—á–∏—Ç—å –ë–î (CSV) üìÑ

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∞–π–ª `expenses_YYYY-MM-DD.csv`.
–°—Ç–æ–ª–±—Ü—ã: `ts,category,store,amount,note`.

### 2.6. –°—É–º–º–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 ‚ûïüîü

–°—á–∏—Ç–∞–µ—Ç —Å—É–º–º—É 10 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∑–∞–ø–∏—Å–µ–π (–µ—Å–ª–∏ –º–µ–Ω—å—à–µ 10 ‚Äî —Å—É–º–º–∏—Ä—É–µ—Ç —Å–∫–æ–ª—å–∫–æ –µ—Å—Ç—å) –∏ –ø–∏—à–µ—Ç:
**¬´–°—É–º–º–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 –æ–ø–µ—Ä–∞—Ü–∏–π: N ‚ÇΩ (–Ω–∞–π–¥–µ–Ω–æ M –∑–∞–ø–∏—Å–µ–π)¬ª.**

### 2.7. –°–ø—Ä–∞–≤–∫–∞ ‚ùì

–ö–æ—Ä–æ—Ç–∫–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ –∫–Ω–æ–ø–∫–∞–º –∏ –ø–æ —Ñ–æ—Ä–º–∞—Ç—É —Å—É–º–º—ã.

---

## 3. –ö–æ–º–∞–Ω–¥—ã, –∫–Ω–æ–ø–∫–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è

**–ö–æ–º–∞–Ω–¥—ã:**

* `/start` ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è/–º–µ–Ω—é
* `/help` ‚Äî —Å–ø—Ä–∞–≤–∫–∞

**–ö–Ω–æ–ø–∫–∏ (–∏–¥–µ—è callback-–∑–Ω–∞—á–µ–Ω–∏–π):**

* `ADD_EXPENSE`, `LIST_RECENT`, `EXPORT_CSV`, `SUM_LAST10`, `HELP`
* –≤–Ω—É—Ç—Ä–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è: `CATEGORY_*`, `STORE_*`, `CUSTOM_CATEGORY`, `CUSTOM_STORE`, `CONFIRM_SAVE`, `CANCEL`

**–°–æ—Å—Ç–æ—è–Ω–∏—è —à–∞–≥–∞ ¬´–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä¬ª:**
`IDLE ‚Üí ASK_CATEGORY ‚Üí ASK_STORE ‚Üí ASK_AMOUNT ‚Üí ASK_NOTE ‚Üí CONFIRM ‚Üí IDLE`

---

## 4. –î–∞–Ω–Ω—ã–µ (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å)

–û–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤ (–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è):

* `user_id` ‚Äî chat_id –≤ Telegram
* `ts_utc` ‚Äî –¥–∞—Ç–∞/–≤—Ä–µ–º—è –ø–æ–∫—É–ø–∫–∏ –≤ UTC (ISO 8601)
* `category` ‚Äî —Å—Ç—Ä–æ–∫–∞ (–∫–∞—Ç–µ–≥–æ—Ä–∏—è/—Ç–∏–ø)
* `store` ‚Äî —Å—Ç—Ä–æ–∫–∞ (–º–∞–≥–∞–∑–∏–Ω/–ø–ª–æ—â–∞–¥–∫–∞)
* `amount` ‚Äî —á–∏—Å–ª–æ —Å —Ç–æ—á–∫–æ–π
* `note` ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
* `created_at` ‚Äî –∫–æ–≥–¥–∞ –∑–∞–ø–∏—Å—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ (UTC, ISO 8601)

---

## 5. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–ø—Ä–æ—Å—Ç–æ –∏ –±–µ–∑ –∫–æ–¥–∞)

–ò–¥–µ—è: —Ä–∞–∑–¥–µ–ª–∏—Ç—å ¬´–∫–∞–∫ –æ–±—â–∞–µ–º—Å—è —Å Telegram¬ª –∏ ¬´–∫–∞–∫ –≤–µ–¥—ë–º —É—á—ë—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤¬ª.

* **Transport (Telegram API)** ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∞–ø–¥–µ–π—Ç—ã (long polling), –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ/—Ñ–∞–π–ª.
* **Dispatcher/Router** ‚Äî —Ä–∞–∑–¥–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ –Ω—É–∂–Ω–æ–º—É –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É (–ø–æ –∫–æ–º–∞–Ω–¥–µ –∏–ª–∏ —Ç–µ–∫—É—â–µ–º—É —à–∞–≥—É –¥–∏–∞–ª–æ–≥–∞).
* **Handlers** ‚Äî ¬´—Ç–æ–Ω–∫–∏–µ¬ª –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä, –ü–æ—Å–ª–µ–¥–Ω–∏–µ, CSV, –°—É–º–º–∞ 10).
* **Service Layer** ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É–º–º—ã, –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –ø–æ–¥—Å—á—ë—Ç—ã.
* **Repository** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –ë–î (CRUD) –±–µ–∑ SQL –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–æ–≤.
* **Storage (SQLite)** ‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ (–∏–Ω–¥–µ–∫—Å –ø–æ `user_id, ts_utc`).

---

## 6. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ üß©

* **Python:** 3.11+ (–ª—É—á—à–µ 3.12)
* **–û–°:** Windows/WSL, Linux –∏–ª–∏ macOS
* **–ë–∞–∑–∞:** SQLite (–≤—Å—Ç—Ä–æ–µ–Ω–∞ –≤ Python ‚Äî `sqlite3`), –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –Ω–µ –Ω—É–∂–µ–Ω

**–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —á–µ—Ä–µ–∑ `pip`:**

* `python-dotenv` ‚Äî —á–∏—Ç–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞ `.env`

> –ü–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è.

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ (–Ω–∏—á–µ–≥–æ —Å—Ç–∞–≤–∏—Ç—å –Ω–µ –Ω—É–∂–Ω–æ):**

* HTTP: `urllib.request`
* –ë–î: `sqlite3`
* –õ–æ–≥–∏: `logging`
* CSV: `csv`
* –î–∞—Ç–∞/–≤—Ä–µ–º—è: `datetime`

**–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–ø–æ –∂–µ–ª–∞–Ω–∏—é, –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏):**

* `flake8` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∏–ª—è/–ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ –∫–æ–¥—É

---

## 7. –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (–∫–æ–≥–¥–∞ –¥–æ–±–∞–≤–∏–º –∫–æ–¥) üöÄ

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –∑–∞–π—Ç–∏ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞.
2. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
python -m venv .venv
# Linux/WSL/macOS:
source .venv/bin/activate
# Windows PowerShell:
# .\.venv\Scripts\Activate.ps1

pip install -r requirements.txt
```

3. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.env` (–Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`):

```env
BOT_TOKEN=PASTE_YOUR_TOKEN_HERE
DB_PATH=./data/expenses.db
LOG_LEVEL=INFO
```

4. –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É –ø–æ–¥ –±–∞–∑—É:

```bash
mkdir -p data
```

5. –ó–∞–ø—É—Å–∫ (–∫–æ–≥–¥–∞ –ø–æ—è–≤–∏—Ç—Å—è –∫–æ–¥):

```bash
python -m src
```

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –¥–æ–±–∞–≤–ª—é –º–∏–Ω–∏-—Ä–∞–∑–¥–µ–ª —Å –¥–∏–∞–≥—Ä–∞–º–º–æ–π Mermaid (–ø–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ FSM ¬´–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä¬ª) –ø—Ä—è–º–æ –≤ –∫–æ–Ω–µ—Ü README, —á—Ç–æ–±—ã –±—ã–ª–æ –Ω–∞–≥–ª—è–¥–Ω–æ.
